["\n        def transformer_part1(token_position: int, head: int, head_size: int, key_cache_layer: List[List[int]], q: List[int]) -> List[int]:\n            return matrix_vec_mul(\n                matrix_row_slice(\n                    matrix_scalar_div(\n                        integer_sqrt(head_size),\n                        matrix_col_slice(\n                            key_cache_layer,\n                            head * head_size,\n                            (head + 1) * head_size\n                        )\n                    ),\n                    0,\n                    token_position\n                ),\n                vec_slice(q, head*head_size, (head + 1)*head_size)\n            )\n        "]
