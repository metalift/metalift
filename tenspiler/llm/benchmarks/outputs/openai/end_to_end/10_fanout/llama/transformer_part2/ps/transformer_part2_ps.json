["\n        def transformer_part2(\n            token_position: int,\n            head: int,\n            head_size: int,\n            key_cache_layer: List[List[int]],\n            attention: List[int]\n        ) -> List[int]:\n\n            return matrix_vec_mul(\n                matrix_transpose(\n                    matrix_col_slice(\n                        matrix_row_slice(key_cache_layer, 0, token_position + 1),\n                        head * head_size,\n                        (head + 1) * head_size\n                    )\n                ),\n                attention[:token_position + 1]\n            )\n        "]
