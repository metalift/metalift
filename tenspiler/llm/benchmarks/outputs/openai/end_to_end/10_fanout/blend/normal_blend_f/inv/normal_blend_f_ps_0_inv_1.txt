
def invariant(base: List[int], active: List[int], i: int, opacity: int, out: List[int]) -> bool:
    return i >= 0 and i <= len(base) and out == vec_elemwise_add(vec_scalar_mul(opacity, active[:i]), vec_scalar_mul((1 - opacity), base[:i]))
